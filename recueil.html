<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>fran· — recueil</title>
  <link rel="stylesheet" href="style.css" />

  <style>
    /* =========================================================
       FONTS
    ========================================================= */

    @font-face {
      font-family: "AdelpheFructidorRegular";
      src: url("Adelphe-FructidorRegular.woff2") format("woff2");
      font-display: swap;
    }

    @font-face {
      font-family: "EscabeauRegular";
      src: url("Escabeau-Regular.otf") format("opentype");
      font-display: swap;
    }

    @font-face {
      font-family: "DINdong";
      src: url("DINdong.ttf") format("truetype");
      font-display: swap;
    }

    @font-face {
      font-family: "PubliFluorNormale";
      src: url("PubliFluorNormale.otf") format("opentype");
      font-display: swap;
    }

    /* =========================================================
       BASE / PLATEAU
    ========================================================= */

    .page {
      min-height: 85vh;
      position: relative;
      overflow: visible;
    }

    /* =========================================================
       RÈGLE DU JEU (sous la 4e de couv)
    ========================================================= */

    .rules-base {
      position: absolute;
      left: 28px;
      right: 28px;
      top: 28px;

      z-index: 1000;

      background: #ffffff;
      border: 6px solid #000;
      box-shadow: 12px 12px 0 #000;
      padding: 28px 28px 22px 28px;
    }

    .rules-title {
      margin: 0 0 22px 0;
      font-family: "EscabeauRegular", sans-serif;
      font-size: 64px;
      line-height: 0.98;
      color: #ff2fa3;
      letter-spacing: -0.01em;
    }

    .rules-title sup {
      font-size: 0.4em;
      vertical-align: super;
      margin-left: 4px;
    }

    .rules-title a {
      animation: none;
      color: inherit;
      text-decoration: none;
      border-bottom: 2px solid currentColor;
    }

    .rules-text {
      margin: 0 0 18px 0;
      font-family: "AdelpheFructidorRegular", serif;
      font-size: 17px;
      line-height: 1.6;
      color: #ff2fa3;
    }

    .rules-footnote {
      margin: 0;
      padding-top: 12px;
      border-top: 2px solid rgba(255, 47, 163, 0.35);

      font-family: "AdelpheFructidorRegular", serif;
      font-size: 14px;
      line-height: 1.5;
      color: #ff2fa3;
    }

    .rules-close {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #fff;
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      width: 30px;
      height: 30px;
      line-height: 24px;
      font-size: 18px;
      cursor: pointer;
      padding: 0;
      color: #ff2fa3;
    }

    /* =========================================================
       POST-ITS (poèmes)
    ========================================================= */

    .postit {
      position: absolute;
      left: 0;
      top: 0;
      cursor: grab;

      width: 360px;
      max-width: 680px;

      --accent: #00a8ff;
      --shadow: #00a8ff;
    }

    .postit.dragging {
      cursor: grabbing;
      user-select: none;
    }

    .postit:hover {
      animation: postit-shake 0.25s steps(2) infinite;
    }

    @keyframes postit-shake {
      0%   { transform: translate(0,0); }
      25%  { transform: translate(-2px,1px); }
      50%  { transform: translate(2px,-1px); }
      75%  { transform: translate(-1px,-2px); }
      100% { transform: translate(0,0); }
    }

    .postit-bar {
      background: var(--accent);
      min-height: 36px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;

      border: 4px solid var(--accent);
      border-bottom: none;
      box-shadow: 12px 12px 0 var(--shadow);
      padding: 6px 8px;
    }

    .postit-title {
      font-family: "PubliFluorNormale", PostBinaire, sans-serif;
      font-size: 18px;
      line-height: 1.05;
      color: #fff;
      opacity: 0.98;

      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      overflow: hidden;
      word-break: break-word;
    }

    .postit-actions {
      display: flex;
      align-items: center;
      gap: 6px;
      flex: 0 0 auto;
    }

    .close-postit {
      background: #fff;
      border: 2px solid var(--accent);
      color: var(--accent);
      width: 24px;
      height: 24px;
      line-height: 18px;
      font-size: 16px;
      cursor: pointer;
      padding: 0;
    }

    .postit-content {
      background: #ffffff;
      border: 4px solid var(--accent);
      box-shadow: 12px 12px 0 var(--shadow);
      padding: 22px;

      font-family: "AdelpheFructidorRegular", serif;
      font-size: 16px;
      line-height: 1.5;
      color: var(--accent);

      max-height: 60vh;
      overflow: auto;
      overscroll-behavior: contain;
    }

    /* =========================================================
       POST-IT 4E DE COUV (devant tout, sans titre)
    ========================================================= */

    .postit-cover {
      width: 560px;
      max-width: 680px;

      z-index: 99999;

      --accent: #ff2fa3;
      --shadow: #ff2fa3;
    }

    .postit-cover .postit-title {
      display: none;
    }

    .postit-cover .postit-bar {
      justify-content: flex-end;
    }

    .postit-cover .postit-content {
      font-family: "DINdong", serif;
      font-size: 19px;
      line-height: 1.35;
      color: #ff2fa3;
    }

    @media (max-width: 700px) {
      .rules-base,
      .postit {
        position: static;
        width: 100% !important;
        max-width: none;
        margin: 18px 0;
      }

      .rules-title {
        font-size: 42px;
      }

      .page {
        min-height: auto;
      }

      .postit-content {
        max-height: 65vh;
      }
    }
  </style>
</head>

<body>

  <div class="page">

    <div id="rules-base" class="rules-base">
      <button class="rules-close" id="close-rules" aria-label="fermer">×</button>

      <h2 class="rules-title">
        Recueil <br> auquel il <br> faudrait <br> trouver <br> un nom<sup><a href="#note-1">1</a></sup>
      </h2>

      <p class="rules-text">
        lorem ipsum
      </p>

      <p class="rules-footnote" id="note-1">
        1 — mais peut-être que donner un nom c'est déjà fermer l'horizon
      </p>
    </div>

  </div>

  <div id="footer-placeholder"></div>

  <div id="glitch-screen">
    <img src="glitch.png" alt="">
  </div>

  <script src="glitch.js"></script>

  <script>
    fetch("footer.html")
      .then(r => r.text())
      .then(html => {
        document.getElementById("footer-placeholder").innerHTML = html;
      });
  </script>

  <script>
  (function () {

    const page = document.querySelector(".page");
    const rules = document.getElementById("rules-base");
    const closeRules = document.getElementById("close-rules");

    const palette = ["#ff2fa3", "#000000", "#00a8ff"];

    let topZ = 500;

    function bringToFront(el) {
      // ✅ la 4e de couv reste toujours au top
      if (el && el.dataset && el.dataset.pin === "top") {
        el.style.zIndex = "99999";
        return;
      }
      topZ += 1;
      el.style.zIndex = topZ;
    }

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;");
    }

    function pickWidthForText(title, body) {
      const text = (title || "") + "\n" + (body || "");
      const len = text.length;

      if (len < 400)  return 360;
      if (len < 900)  return 420;
      if (len < 1600) return 520;
      return 620;
    }

    function randomizeInPage(el, container) {
      const minVisible = 80;

      const safeW = Math.max(container.clientWidth, 680);
      const safeH = Math.max(container.clientHeight, Math.floor(window.innerHeight * 0.85));

      const maxX = safeW - minVisible;
      const maxY = safeH - minVisible;

      const minX = -(el.offsetWidth - minVisible);
      const minY = -(el.offsetHeight - minVisible);

      const x = minX + Math.random() * (maxX - minX);
      const y = minY + Math.random() * (maxY - minVisible);

      el.style.left = x + "px";
      el.style.top  = y + "px";
    }

    function makeDraggable(el) {
      let dragging = false, startX = 0, startY = 0, startLeft = 0, startTop = 0;

      el.addEventListener("mousedown", startDrag);
      el.addEventListener("touchstart", startDrag, { passive: false });

      function startDrag(e) {
        if (e.target && e.target.classList && e.target.classList.contains("close-postit")) return;

        bringToFront(el);

        const evt = e.touches ? e.touches[0] : e;
        dragging = true;
        el.classList.add("dragging");

        startX = evt.clientX;
        startY = evt.clientY;
        startLeft = el.offsetLeft;
        startTop = el.offsetTop;

        document.addEventListener("mousemove", drag);
        document.addEventListener("mouseup", stopDrag);
        document.addEventListener("touchmove", drag, { passive: false });
        document.addEventListener("touchend", stopDrag);
      }

      function drag(e) {
        if (!dragging) return;
        e.preventDefault();
        const evt = e.touches ? e.touches[0] : e;
        el.style.left = startLeft + (evt.clientX - startX) + "px";
        el.style.top  = startTop  + (evt.clientY - startY) + "px";
      }

      function stopDrag() {
        dragging = false;
        el.classList.remove("dragging");
        document.removeEventListener("mousemove", drag);
        document.removeEventListener("mouseup", stopDrag);
        document.removeEventListener("touchmove", drag);
        document.removeEventListener("touchend", stopDrag);
      }
    }

    function buildPostit({ title, body }, accent, extraClass = "") {
      const wrap = document.createElement("div");
      wrap.className = `postit post-binaire-texte ${extraClass}`.trim();

      wrap.style.setProperty("--accent", accent);
      wrap.style.setProperty("--shadow", accent);

      wrap.style.zIndex = String(50 + Math.floor(Math.random() * 350));

      const titleHtml = title ? escapeHtml(title) : "";

      wrap.innerHTML = `
        <div class="postit-bar">
          <span class="postit-title">${titleHtml}</span>
          <div class="postit-actions">
            <button class="close-postit" aria-label="fermer">×</button>
          </div>
        </div>
        <div class="postit-content"></div>
      `;

      if (!title) {
        wrap.querySelector(".postit-title").textContent = "";
      }

      wrap.style.width = pickWidthForText(title, body) + "px";
      wrap.querySelector(".postit-content").innerHTML = body || "";

      wrap.querySelector(".close-postit").addEventListener("click", (e) => {
        e.stopPropagation();
        wrap.style.display = "none";
      });

      wrap.addEventListener("click", () => bringToFront(wrap));

      page.appendChild(wrap);

      requestAnimationFrame(() => {
        if (!window.matchMedia("(max-width: 700px)").matches) {
          randomizeInPage(wrap, page);
        }
      });

      makeDraggable(wrap);
      return wrap;
    }

    // 4E DE COUV (pinned top)
    const coverText = `« j’ai commencé à écrire pour essayer de trouver le chemin des temples cachés sur mes îles intérieures et dont j’ignore encore, un jour sur deux, la voie d’accès. le soleil peut aider, la lune aussi mais le monde tangible — celui que beaucoup appelle "le vrai" — est une vraie plaie : il bourdonne trop fort et ne fait pas beaucoup de miel. »`;

    const cover = buildPostit(
      { title: "", body: coverText },
      "#ff2fa3",
      "postit-cover"
    );
    cover.dataset.pin = "top";
    cover.style.zIndex = "99999";

    // 15 POÈMES (1 rempli)
    const poems = [
      {
        title: "",
        body: `quatre heures du mat<br>
je dors pas et c’est pas parce que j’ai trop bu<br>
c’est une nouvelle manie de mon corps<br>
le refus<br><br>

j’essaie d’écrire un poème<br>
il contiendrait le nom de<br>
tous les pays colonisés<br>
dans le monde mais<br><br>

flicaille<br>
y en a trop<br>
je sais plus quoi faire<br>
j’ai peur d’en oublier<br><br>

je me rappelle de marker<br>
qui se demande où sont cell..eux qui<br>
avec le che<br>
tremblent d’indignation à chaque fois qu’une injustice est commise dans le monde<br><br>

moi jte jure<br>
je ne tremble plus<br>
à ce stade<br>
c’est carrément une crise d’épilepsie`
      },
      
{ title: "", body: `lui : « mais alors ce livre, vous allez le faire ? que je vous donne une bourse ou non ? vous trouverez de <em>toute façon</em> un moyen de le faire, je me trompe ? »<br><br>

moi : « oui je le ferai. non, vous ne vous trompez pas. »<br><br>

lui : « alors : ça ne sert à rien que je vous aide. »<br><br>

silence<br><br>

lui : « vous, vous faite de la poésie-guérilla, l’argent ne vous servirait à rien. »<br><br><br>

<em>claquement de porte sur mon pif</em><br>
<em>bye</em><br><br><br>

— des fois je ne devrais pas être honnête<br>
je devrais assumer de tricher<br>
leur dire que j’ai trop besoin d’eux des fois<br>
je devrais lécher un ou deux culs mais<br><br><br>

<em>déso</em><br>
<em>je suis hyper sélectif..ve quand il s’agit de boule —</em><br><br>

alors<br>
je suis rentré..e chez moi<br>
j’ai rempli le frigo de colère<br>
de mots de colère<br>
de poésie de colère<br>
de livres entiers sous acide colérique parce que c’était tout ce qui me restait<br>
et j’ai continué à faire une guerre qu’on me prête mais que je n’ai jamais voulue<br>
j’ai continué la guérilla avec des mots quand je voulais seulement parler d’amour<br>
d’autres possibles<br>
de l’autre monde<br>
celui qui est derrière le monde<br>
derrière les ombres<br>
derrière l’idée qu’il se fait de lui-même<br><br><br>

c’est con`
 }, 
      
      { title: "", body: "" }, { title: "", body: "" }, { title: "", body: "" },
      { title: "", body: "" }, { title: "", body: "" }, { title: "", body: "" }, { title: "", body: "" },
      { title: "", body: "" }, { title: "", body: "" }, { title: "", body: "" }, { title: "", body: "" },
      { title: "", body: "" }, { title: "", body: "" }
    ];

    poems.forEach((p, i) => {
      const accent = palette[i % palette.length];
      buildPostit(p, accent);
    });

    closeRules.addEventListener("click", () => {
      rules.style.display = "none";
    });

  })();
  </script>

</body>
</html>
